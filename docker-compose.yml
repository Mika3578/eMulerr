services:
  # poc:
  #   image: ${DOCKER_REGISTRY-}poc
  #   build:
  #     context: POC
  #     dockerfile: Dockerfile
  #   volumes:
  #     - ./volume/data:/data
  #   environment:
  #     - RADARR_URL=http://radarr:7878
  #     - RADARR_API_KEY=304cc33ba5024182ab5a2f408f843962

  sonarr: # tv
    container_name: sonarr
    image: lscr.io/linuxserver/sonarr:latest
    ports:
      - 8989:8989
    environment:
      - PUID=0
      - PGID=0
      - TZ=UTC
    volumes:
      - ./volume/sonarr-config:/config
      - ./volume/data:/data
    restart: unless-stopped
    depends_on:
      emulerr:
        condition: service_healthy

  radarr: # download movies
    container_name: radarr
    image: lscr.io/linuxserver/radarr:latest
    ports:
      - 7878:7878
    environment:
      - PUID=0
      - PGID=0
      - TZ=UTC
    volumes:
      - ./volume/radarr-config:/config
      - ./volume/data:/data
    restart: unless-stopped
    depends_on:
      emulerr:
        condition: service_healthy

  lazylibrarian: # books/ebooks
    container_name: lazylibrarian
    image: lscr.io/linuxserver/lazylibrarian:latest
    ports:
      - 5299:5299
    environment:
      - PUID=0
      - PGID=0
      - TZ=UTC
    volumes:
      - ./volume/lazylibrarian-config:/config
      - ./volume/data/usenet:/downloads
      - ./volume/data/books:/books
    restart: unless-stopped
    depends_on:
      emulerr:
        condition: service_healthy

  pymedusa: # tv (alternative to sonarr) - medusa is the current name
    container_name: pymedusa
    image: lscr.io/linuxserver/medusa:latest
    ports:
      - 8081:8081
    environment:
      - PUID=0
      - PGID=0
      - TZ=UTC
    volumes:
      - ./volume/pymedusa-config:/config
      - ./volume/data:/data
    restart: unless-stopped
    depends_on:
      emulerr:
        condition: service_healthy

  readarr: # ebooks/audiobooks (deprecated - upstream retired, linuxserver image uses :develop)
    container_name: readarr
    image: lscr.io/linuxserver/readarr:develop
    ports:
      - 8787:8787
    environment:
      - PUID=0
      - PGID=0
      - TZ=UTC
    volumes:
      - ./volume/readarr-config:/config
      - ./volume/data:/data
    restart: unless-stopped
    depends_on:
      emulerr:
        condition: service_healthy

  lidarr: # music
    container_name: lidarr
    image: lscr.io/linuxserver/lidarr:latest
    ports:
      - 8686:8686
    environment:
      - PUID=0
      - PGID=0
      - TZ=UTC
    volumes:
      - ./volume/lidarr-config:/config
      - ./volume/data:/data
    restart: unless-stopped
    depends_on:
      emulerr:
        condition: service_healthy

  emulerr:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        - IMG_VER=2025-01-01_fafafaf
    image: isc30/emulerr:latest
    container_name: emulerr
    restart: unless-stopped
    tty: true
    environment:
      - PUID=1000
      - PGID=1000
      - PORT=3000 # optional, default=3000
      - ED2K_PORT=4762 # optional, default=4662
      - LOG_LEVEL=info # optional, default=info
      - PASSWORD=1234 # optional, user=emulerr
    ports:
      - "3000:3000" # web ui
      - "4662:4662" # ed2k tcp
      - "4665:4665/udp" # ed2k global search udp (tcp port +3)
      - "4672:4672/udp" # ed2k udp
      - "4711:4711" # DEV, amule webui
    volumes:
      - ./volume/config:/config
      - ./volume/data/usenet:/downloads

      # DEV MOUNTS (comment out to run production)
      # - ./src:/emulerr-dev # DEV mount
      # - type: bind
      #   source: ./src/amule/api.php
      #   target: /usr/share/amule/webserver/AmuleWebUI-Reloaded/api.php
      # - type: bind
      #   source: ./src/entrypoint.sh
      #   target: /home/entrypoint.sh
